<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>سەرژمێری هێلکە</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100..900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <style>
    .farm-1-row {
      background-color: #f8f9fa !important;
    }

    .farm-2-row {
      background-color: #d1e7dd !important;
    }

    .farm-3-row {
      background-color: #f8d7da !important;
    }

    .farm-4-row {
      background-color: #cfe2ff !important;
    }

    .total-row {
      background-color: #fff3cd !important;
      font-weight: bold;
    }

    /* Pagination Styles */
    .pagination-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .pagination-info {
      color: #666;
      font-size: 14px;
    }

    .pagination-controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .pagination-controls button {
      padding: 8px 16px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .pagination-controls button:hover:not(:disabled) {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .pagination-controls button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination-controls .page-number {
      padding: 8px 12px;
      background: #667eea;
      color: white;
      border-radius: 5px;
      font-weight: 600;
    }

    .page-size-selector {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .page-size-selector select {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      cursor: pointer;
    }

    /* Receipt Styles */

    #receiptContainer {
      position: fixed;
      left: -9999px;
      top: 0;
      width: 210mm;
      min-height: 297mm;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 0;
      font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      direction: rtl;
    }

    .receipt-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 40px;
      text-align: center;
      color: white;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .receipt-header h1 {
      font-size: 42px;
      font-weight: 900;
      margin: 0 0 10px 0;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .receipt-header h2 {
      font-size: 20px;
      font-weight: 400;
      margin: 0;
      opacity: 0.95;
    }

    .receipt-body {
      padding: 30px 40px;
    }

    .info-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .info-card {
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      border-right: 5px solid #667eea;
    }

    .info-card h3 {
      font-size: 18px;
      font-weight: 700;
      color: #2d3748;
      margin: 0 0 15px 0;
      padding-bottom: 10px;
      border-bottom: 2px solid #e2e8f0;
    }

    .info-card p {
      margin: 8px 0;
      color: #4a5568;
      font-size: 14px;
      line-height: 1.6;
    }

    .info-card strong {
      color: #2d3748;
      font-weight: 600;
    }

    .summary-section {
      background: white;
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .summary-title {
      text-align: center;
      font-size: 26px;
      font-weight: 800;
      color: #2d3748;
      margin: 0 0 25px 0;
      padding-bottom: 15px;
      border-bottom: 3px solid #667eea;
    }

    .summary-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    .summary-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 25px;
      border-radius: 15px;
      text-align: center;
      color: white;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
      transition: transform 0.3s;
    }

    .summary-card:nth-child(2) {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      box-shadow: 0 8px 20px rgba(245, 87, 108, 0.4);
    }

    .summary-card:nth-child(3) {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      box-shadow: 0 8px 20px rgba(79, 172, 254, 0.4);
    }

    .summary-card h4 {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 12px 0;
      opacity: 0.95;
    }

    .summary-card .value {
      font-size: 32px;
      font-weight: 900;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
    }

    .table-section {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .table-title {
      text-align: center;
      font-size: 22px;
      font-weight: 700;
      color: #2d3748;
      margin: 0 0 20px 0;
      padding-bottom: 12px;
      border-bottom: 2px solid #e2e8f0;
    }

    .receipt-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    .receipt-table thead {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .receipt-table th {
      padding: 15px;
      text-align: center;
      font-weight: 700;
      font-size: 14px;
    }

    .receipt-table th:first-child {
      border-radius: 10px 0 0 0;
    }

    .receipt-table th:last-child {
      border-radius: 0 10px 0 0;
    }

    .receipt-table td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #e2e8f0;
      color: #4a5568;
      font-size: 13px;
    }

    .receipt-table tbody tr:nth-child(even) {
      background-color: #f7fafc;
    }

    .receipt-table tbody tr:hover {
      background-color: #edf2f7;
    }

    .receipt-table tbody tr:last-child td {
      border-bottom: none;
    }

    .receipt-footer {
      background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
      padding: 25px 40px;
      color: white;
      text-align: center;
    }

    .footer-line {
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, #667eea, transparent);
      margin-bottom: 15px;
    }

    .receipt-footer p {
      margin: 8px 0;
      font-size: 12px;
      opacity: 0.9;
    }

    .receipt-footer .copyright {
      font-weight: 700;
      font-size: 13px;
      margin-top: 12px;
    }

    .watermark {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-45deg);
      font-size: 120px;
      font-weight: 900;
      color: rgba(102, 126, 234, 0.03);
      z-index: 0;
      pointer-events: none;
    }
  @media (max-width: 767px) {
      /* Mobile styles */
      
      /* Pagination Container - Stack vertically on mobile */
      .pagination-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 15px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      /* Page Size Selector - First row */
      .page-size-selector {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        font-size: 11px;
        flex-wrap: wrap;
        order: 1;
      }

      .page-size-selector label {
        font-size: 11px;
      }

      .page-size-selector select {
        padding: 6px 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        cursor: pointer;
        font-size: 11px;
      }

      /* Pagination Info - Second row */
      .pagination-info {
        color: #666;
        font-size: 10px;
        text-align: center;
        order: 2;
      }

      /* Pagination Controls - Third row */
      .pagination-controls {
        display: flex;
        gap: 5px;
        align-items: center;
        justify-content: center;
        order: 3;
      }

      .pagination-controls button {
        padding: 6px 10px;
        border: 1px solid #ddd;
        background: white;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 11px;
        min-width: 35px;
      }

      .pagination-controls button i {
        font-size: 12px;
      }

      .pagination-controls button:hover:not(:disabled) {
        background: #667eea;
        color: white;
        border-color: #667eea;
      }

      .pagination-controls button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .pagination-controls .page-number {
        padding: 6px 10px;
        background: #667eea;
        color: white;
        border-radius: 5px;
        font-weight: 600;
        font-size: 10px;
        white-space: nowrap;
      }

      /* Table adjustments for mobile */
      .table-responsive {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .table {
        font-size: 11px;
        min-width: 600px;
      }

      .table thead th {
        padding: 8px 4px;
        font-size: 10px;
      }

      .table tbody td {
        padding: 8px 4px;
        font-size: 10px;
      }

      /* Card adjustments */
      .card {
        margin-bottom: 15px;
      }

      .card-body {
        padding: 15px !important;
      }

      .card-title {
        font-size: 13px !important;
      }

      .card-icon {
        width: 50px !important;
        height: 50px !important;
      }

      .card-icon i {
        font-size: 20px !important;
      }

      /* Filter section adjustments */
      .form-floating {
        margin-bottom: 10px;
      }

      .form-floating label {
        font-size: 12px;
      }

      .form-control, .form-select {
        font-size: 12px;
        padding: 10px;
      }

      /* Button adjustments */
      .btn {
        font-size: 11px;
        padding: 8px 12px;
        margin: 3px;
      }

      .btn i {
        font-size: 12px;
      }

      /* Header adjustments */
      .pagetitle h1 {
        font-size: 20px;
      }

      .breadcrumb {
        font-size: 11px;
      }

      /* Individual farm summaries */
      .col-lg-3 {
        margin-bottom: 15px;
      }

      /* Hide some text on very small screens */
      .page-size-selector span:first-of-type {
        display: none;
      }

      .page-size-selector span:last-of-type {
        font-size: 10px;
      }
    }

    /* Extra small phones */
    @media (max-width: 480px) {
      .pagination-controls button {
        padding: 5px 8px;
        min-width: 30px;
      }

      .pagination-controls .page-number {
        padding: 5px 8px;
        font-size: 9px;
      }

      .pagination-info {
        font-size: 9px;
      }

      .page-size-selector {
        font-size: 10px;
      }

      .page-size-selector select {
        font-size: 10px;
        padding: 5px 8px;
      }

      /* Stack filter buttons vertically */
      .text-center.mb-3 {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .text-center.mb-3 .btn {
        width: 100%;
      }

      /* Smaller cards */
      .card-body h6 {
        font-size: 18px !important;
      }

      .card-body .text-muted {
        font-size: 10px !important;
      }
    }
  </style>
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center">

    <div class="d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center">
        <span class="d-none d-lg-block">سەرژمێری هێلکە</span>
      </a>
      <i class="bi bi-list toggle-sidebar-btn"></i>
    </div><!-- End Logo -->

    <nav class="header-nav ms-auto">
      <ul class="d-flex align-items-center">

        <li class="nav-item dropdown pe-3">

          <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
            <i class="bi bi-person-circle"></i> <span class="d-none d-md-block dropdown-toggle ps-2"
              id="headerUsername">بەڵێن</span>
          </a><!-- End Profile Iamge Icon -->

          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
            <li class="dropdown-header">
              <h6 id="headerFullName">بەڵێن بەختیار</h6>
              <span id="headerUserType">ئەدمین</span>
            </li>

            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="#" onclick="logout()">
                <i class="bi bi-box-arrow-left"></i>
                <span>چوونە دەرەوە</span>
              </a>
            </li>

          </ul><!-- End Profile Dropdown Items -->
        </li><!-- End Profile Nav -->

      </ul>
    </nav><!-- End Icons Navigation -->

  </header><!-- End Header -->

  <!-- ======= Sidebar ======= -->
  <aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">

      <li class="nav-item">
        <a class="nav-link collapsed" href="index.html">
          <i class="bi bi-grid"></i>
          <span>داشبۆرد</span>
        </a>
      </li><!-- End Dashboard Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#components-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-house-door"></i><span>فارمەکان</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="components-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="farm1.html">
              <i class="bi bi-circle"></i><span>فارمی یەکەم</span>
            </a>
          </li>
          <li>
            <a href="farm2.html">
              <i class="bi bi-circle"></i><span>فارمی دووەم</span>
            </a>
          </li>
          <li>
            <a href="farm3.html">
              <i class="bi bi-circle"></i><span>فارمی سێیەم</span>
            </a>
          </li>
          <li>
            <a href="farm4.html">
              <i class="bi bi-circle"></i><span>فارمی چوارەم</span>
            </a>
          </li>
        </ul>
      </li><!-- End Components Nav -->

      <li class="nav-heading">بەشەکان</li>

      <li class="nav-item">
        <a class="nav-link" href="calculation.html">
          <i class="bi bi-calculator"></i>
          <span>سەرژمێری</span>
        </a>
      </li><!-- End Profile Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" onclick="alert('ئەم خزمەتگوزاریە جارێ بەردەست نییە!');"
        >
          <i class="bi bi-gear"></i>
          <span>ڕێکخستن</span>
        </a>
      </li><!-- End F.A.Q Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="#" onclick="logout()">
          <i class="bi bi-box-arrow-left"></i>
          <span>چوونە دەرەوە</span>
        </a>
      </li><!-- End Login Page Nav -->
    </ul>

  </aside><!-- End Sidebar-->

  <main id="main" class="main">

    <div class="pagetitle">
      <h1>سەرژمێری</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item active">سەرژمێری</li>
          <li class="breadcrumb-item"><a href="index.html">داشبۆرد</a></li>
        </ol>
      </nav>
    </div><!-- End Page Title -->

    <!-- Summary Cards -->
    <section class="section dashboard">
      <div class="row" dir="">
        <div class="col-xxl-3 col-md-6">
          <div class="card info-card sales-card pt-0">
            <div class="card-body">
              <h5 class="card-title">کۆی گشتی <span>| هێلکە</span></h5>
              <div class="d-flex align-items-center">
                <div class="card card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-egg"></i>
                </div>
                <div class="ps-3">
                  <h6 id="totalEggsCard">0</h6>
                  <span class="text-muted small pt-2 ps-1">هێلکە</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xxl-3 col-md-6">
          <div class="card info-card revenue-card pt-0">
            <div class="card-body">
              <h5 class="card-title">کۆی گشتی <span>| تەبەق</span></h5>
              <div class="d-flex align-items-center">
                <div class="card card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-stack"></i>
                </div>
                <div class="ps-3">
                  <h6 id="totalFlatsCard">0</h6>
                  <span class="text-muted small pt-2 ps-1">تەبەق</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xxl-3 col-md-6">
          <div class="card info-card customers-card pt-0">
            <div class="card-body">
              <h5 class="card-title">کۆی گشتی <span>| کارتۆن</span></h5>
              <div class="d-flex align-items-center">
                <div class="card card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-box"></i>
                </div>
                <div class="ps-3">
                  <h6 id="totalPacketsCard">0</h6>
                  <span class="text-muted small pt-2 ps-1">کارتۆن</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xxl-3 col-md-6">
          <div class="card  info-card pt-0">
            <div class="card-body">
              <h5 class="card-title">کۆی <span>| تۆمارەکان</span></h5>
              <div class="d-flex align-items-center">
                <div class="card card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-file-text"></i>
                </div>
                <div class="ps-3">
                  <h6 id="totalRecordsCard">0</h6>
                  <span class="text-muted small pt-2 ps-1">تۆمار</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Advanced Filters -->
    <section class="section">
      <div class="row" dir="rtl">
        <div class="col-lg-12">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">فلتەرکردن و گەڕان</h5>

              <div class="row">
                <!-- Farm Filter -->
                <div class="col-md-4">
                  <div class="form-floating mb-3">
                    <select class="form-select" id="filterFarm">
                      <option value="">هەموو فارمەکان</option>
                      <option value="1">فارمی یەکەم</option>
                      <option value="2">فارمی دووەم</option>
                      <option value="3">فارمی سێیەم</option>
                      <option value="4">فارمی چوارەم</option>
                    </select>
                    <label for="filterFarm">هەڵبژاردنی فارم</label>
                  </div>
                </div>
                <!-- Search -->
                <div class="col-md-4">
                  <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="searchInput" placeholder="گەڕان...">
                    <label for="searchInput">گەڕان (هێلکە، تەبەق، کارتۆن)</label>
                  </div>
                </div>

                <!-- Sort -->
                <div class="col-md-4">
                  <div class="form-floating mb-3">
                    <select class="form-select" id="sortBy">
                      <option value="date-desc">بەرواری نوێترین</option>
                      <option value="date-asc">بەرواری کۆنترین</option>
                      <option value="eggs-desc">هێلکە (زۆرترین)</option>
                      <option value="eggs-asc">هێلکە (کەمترین)</option>
                      <option value="farm-asc">فارم (1-4)</option>
                    </select>
                    <label for="sortBy">ڕیزکردن</label>
                  </div>
                </div>



                <!-- Quick Filters -->
                <div class="col-md-4">
                  <div class="form-floating mb-3">
                    <select class="form-select" id="filterQuick" onchange="applyQuickFilter()">
                      <option value="">هەڵبژاردن</option>
                      <option value="today">ئەمڕۆ</option>
                      <option value="week">حەفتەی ڕابردوو (7 ڕۆژ)</option>
                      <option value="month">مانگی ڕابردوو (30 ڕۆژ)</option>
                      <option value="month1">مانگی یەکەم</option>
                      <option value="month2">مانگی دووەم</option>
                      <option value="month3">مانگی سێیەم</option>
                      <option value="month4">مانگی چوارەم</option>
                      <option value="month5">مانگی پێنجەم</option>
                      <option value="month6">مانگی شەشەم</option>
                      <option value="month7">مانگی حەوتەم</option>
                      <option value="month8">مانگی هەشتەم</option>
                      <option value="month9">مانگی نۆیەم</option>
                      <option value="month10">مانگی دەیەم</option>
                      <option value="month11">مانگی یازدەیەم</option>
                      <option value="month12">مانگی دوانزەیەم</option>
                    </select>
                    <label for="filterQuick">فلتەری خێرا</label>
                  </div>
                </div>
                <!-- Date Range -->
                <div class="col-md-3">
                  <div class="form-floating mb-5">
                    <input type="date" class="form-control" id="filterDateFrom">
                    <label for="filterDateFrom">لە بەرواری</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-floating mb-3">
                    <input type="date" class="form-control" id="filterDateTo">
                    <label for="filterDateTo">بۆ بەرواری</label>
                  </div>
                </div>
                <!-- Year -->
                <div class="col-md-2">
                  <div class="form-floating mb-3">
                    <input type="number" class="form-control" id="filterYear" value="2026">
                    <label for="filterYear">ساڵ</label>
                  </div>
                </div>



                <!-- Filter Buttons -->
                <div class="col-md-12 text-center mb-3">
                  <button class="btn btn-primary" onclick="applyFilters()">
                    <i class="bi bi-funnel"></i> فلتەرکردن
                  </button>
                  <button class="btn btn-secondary" onclick="clearFilters()">
                    <i class="bi bi-x-circle"></i> سڕینەوەی فلتەر
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Farms calculation section -->
    <section class="section">
      <div class="row" dir="rtl">
        <div class="col-lg-12">

          <div class="card">
            <div class="card-body">

              <h5 class="card-title">سەرژمێری کۆی فارمەکان</h5>

              <div class="table-responsive">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">فارم</th>
                      <th scope="col">هێلکە</th>
                      <th scope="col">تەبەق</th>
                      <th scope="col">کارتۆن</th>
                      <th scope="col">بەرواری داخڵکردن</th>
                      <th scope="col">بەرواری گۆڕین</th>
                    </tr>
                  </thead>
                  <tbody id="calculationTableBody">
                    <tr>
                      <td colspan="7" class="text-center">چاوەڕێی داتا...</td>
                    </tr>
                  </tbody>
                  <tfoot id="calculationTableFooter" style="display: none;">
                    <tr class="total-row table-dark">
                      <td colspan="2"><strong>کۆی گشتی</strong></td>
                      <td><strong id="footerTotalEggs">0</strong></td>
                      <td><strong id="footerTotalFlats">0</strong></td>
                      <td><strong id="footerTotalPackets">0</strong></td>
                      <td colspan="2"><strong id="footerTotalRecords">0 تۆمار</strong></td>
                    </tr>
                  </tfoot>
                </table>
              </div>

              <!-- Pagination Controls -->
              <div class="pagination-container">
                <div class="page-size-selector">
                  <label>نیشاندانی:</label>
                  <select id="pageSize" onchange="changePageSize()">
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                  </select>
                  <span>تۆمار لە هەر پەڕەیەک</span>
                </div>

                <div class="pagination-info">
                  نیشاندانی <strong id="showingFrom">0</strong> بۆ <strong id="showingTo">0</strong> لە <strong
                    id="totalItems">0</strong> تۆمار
                </div>

                <div class="pagination-controls">
                  <button onclick="goToFirstPage()" id="firstPageBtn">
                    <i class="bi bi-chevron-double-right"></i>
                  </button>
                  <button onclick="previousPage()" id="prevPageBtn">
                    <i class="bi bi-chevron-right"></i>
                  </button>
                  <span class="page-number">
                    پەڕەی <strong id="currentPage">1</strong> لە <strong id="totalPages">1</strong>
                  </span>
                  <button onclick="nextPage()" id="nextPageBtn">
                    <i class="bi bi-chevron-left"></i>
                  </button>
                  <button onclick="goToLastPage()" id="lastPageBtn">
                    <i class="bi bi-chevron-double-left"></i>
                  </button>
                </div>
              </div>

            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- Individual Farm Summaries -->
    <section class="section">
      <div class="row" dir="rtl">
        <div class="col-lg-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" style="background-color: #f8f9fa; padding: 10px; border-radius: 5px;">فارمی یەکەم
              </h5>
              <p>هێلکە: <strong id="farm1Eggs">0</strong></p>
              <p>تەبەق: <strong id="farm1Flats">0</strong></p>
              <p>کارتۆن: <strong id="farm1Packets">0</strong></p>
              <p>تۆمار: <strong id="farm1Records">0</strong></p>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" style="background-color: #d1e7dd; padding: 10px; border-radius: 5px;">فارمی دووەم
              </h5>
              <p>هێلکە: <strong id="farm2Eggs">0</strong></p>
              <p>تەبەق: <strong id="farm2Flats">0</strong></p>
              <p>کارتۆن: <strong id="farm2Packets">0</strong></p>
              <p>تۆمار: <strong id="farm2Records">0</strong></p>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" style="background-color: #f8d7da; padding: 10px; border-radius: 5px;">فارمی سێیەم
              </h5>
              <p>هێلکە: <strong id="farm3Eggs">0</strong></p>
              <p>تەبەق: <strong id="farm3Flats">0</strong></p>
              <p>کارتۆن: <strong id="farm3Packets">0</strong></p>
              <p>تۆمار: <strong id="farm3Records">0</strong></p>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" style="background-color: #cfe2ff; padding: 10px; border-radius: 5px;">فارمی چوارەم
              </h5>
              <p>هێلکە: <strong id="farm4Eggs">0</strong></p>
              <p>تەبەق: <strong id="farm4Flats">0</strong></p>
              <p>کارتۆن: <strong id="farm4Packets">0</strong></p>
              <p>تۆمار: <strong id="farm4Records">0</strong></p>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="copyright">
      &copy; Copyright <strong><span>Ballen Baxtyar</span></strong>. All Rights Reserved
    </div>
    <div class="credits">
      Designed by <a href="https://ballenio.vercel.app/">Ballen Baxtyar</a>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>

  <!-- Hidden Receipt Container -->
  <div id="receiptContainer"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/chart.js/chart.umd.js"></script>
  <script src="assets/vendor/echarts/echarts.min.js"></script>
  <script src="assets/vendor/quill/quill.js"></script>
  <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="assets/vendor/tinymce/tinymce.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

  <!-- Auth Script -->
  <script src="assets/js/auth.js"></script>

  <!-- Libraries for PDF generation from HTML -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // Check authentication
    const currentUser = checkAuth();
    if (currentUser) {
      document.getElementById('headerUsername').textContent = currentUser.firstname;
      document.getElementById('headerFullName').textContent = `${currentUser.firstname} ${currentUser.lastname}`;
      document.getElementById('headerUserType').textContent = currentUser.type;
    }

    let allRecords = [];
    let filteredRecords = [];

    // Pagination variables
    let currentPage = 1;
    let pageSize = 5;
    let totalPages = 1;

    // Farm names in Kurdish
    const farmNames = {
      1: 'فارمی یەکەم',
      2: 'فارمی دووەم',
      3: 'فارمی سێیەم',
      4: 'فارمی چوارەم'
    };

    // Load all farm data
    async function loadAllFarmsData() {
      try {
        const token = localStorage.getItem('token');

        const promises = [1, 2, 3, 4].map(farmNum =>
          fetch(`/farm${farmNum}`, {
            headers: { 'Authorization': `Bearer ${token}` }
          }).then(res => res.json())
        );

        const results = await Promise.all(promises);

        allRecords = [];
        results.forEach((result, index) => {
          const farmNumber = index + 1;
          if (result.records) {
            result.records.forEach(record => {
              allRecords.push({
                ...record,
                farmNumber: farmNumber,
                farmName: farmNames[farmNumber]
              });
            });
          }
        });

        filteredRecords = [...allRecords];
        currentPage = 1;
        displayRecords(filteredRecords);
        updateSummaryCards(filteredRecords);
        updateFarmSummaries(allRecords);

      } catch (error) {
        console.error('Error loading farms data:', error);
        alert('هەڵەیەک ڕوویدا لە بارکردنی داتاکان');
      }
    }

    // Display records in table with pagination
    function displayRecords(records) {
      const tbody = document.getElementById('calculationTableBody');
      const tfoot = document.getElementById('calculationTableFooter');

      if (records.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="text-center">هیچ داتایەک نییە</td></tr>';
        tfoot.style.display = 'none';
        updatePaginationInfo(0, 0, 0);
        return;
      }

      // Calculate pagination
      totalPages = Math.ceil(records.length / pageSize);
      const startIndex = (currentPage - 1) * pageSize;
      const endIndex = Math.min(startIndex + pageSize, records.length);
      const paginatedRecords = records.slice(startIndex, endIndex);

      tbody.innerHTML = paginatedRecords.map((record, index) => `
        <tr class="farm-${record.farmNumber}-row">
          <td>${startIndex + index + 1}</td>
          <td><strong>${record.farmName}</strong></td>
          <td>${record.eggs.toLocaleString()}</td>
          <td>${record.flats.toFixed(2)}</td>
          <td>${record.packets.toFixed(2)}</td>
          <td>${new Date(record.createdAt).toLocaleDateString('en-GB')}</td>
          <td>${record.updatedAt ? new Date(record.updatedAt).toLocaleDateString('en-GB') : '-'}</td>
        </tr>
      `).join('');

      // Update footer totals (for ALL filtered records, not just current page)
      const totalEggs = records.reduce((sum, r) => sum + r.eggs, 0);
      const totalFlats = records.reduce((sum, r) => sum + r.flats, 0);
      const totalPackets = records.reduce((sum, r) => sum + r.packets, 0);

      document.getElementById('footerTotalEggs').textContent = totalEggs.toLocaleString();
      document.getElementById('footerTotalFlats').textContent = totalFlats.toFixed(2);
      document.getElementById('footerTotalPackets').textContent = totalPackets.toFixed(2);
      document.getElementById('footerTotalRecords').textContent = `${records.length} تۆمار`;
      tfoot.style.display = 'table-footer-group';

      // Update pagination info
      updatePaginationInfo(startIndex + 1, endIndex, records.length);
    }

    // Update pagination info and buttons
    function updatePaginationInfo(from, to, total) {
      document.getElementById('showingFrom').textContent = from;
      document.getElementById('showingTo').textContent = to;
      document.getElementById('totalItems').textContent = total;
      document.getElementById('currentPage').textContent = currentPage;
      document.getElementById('totalPages').textContent = totalPages;

      // Enable/disable buttons
      document.getElementById('firstPageBtn').disabled = currentPage === 1;
      document.getElementById('prevPageBtn').disabled = currentPage === 1;
      document.getElementById('nextPageBtn').disabled = currentPage === totalPages || totalPages === 0;
      document.getElementById('lastPageBtn').disabled = currentPage === totalPages || totalPages === 0;
    }

    // Pagination functions
    function nextPage() {
      if (currentPage < totalPages) {
        currentPage++;
        displayRecords(filteredRecords);
      }
    }

    function previousPage() {
      if (currentPage > 1) {
        currentPage--;
        displayRecords(filteredRecords);
      }
    }

    function goToFirstPage() {
      currentPage = 1;
      displayRecords(filteredRecords);
    }

    function goToLastPage() {
      currentPage = totalPages;
      displayRecords(filteredRecords);
    }

    function changePageSize() {
      pageSize = parseInt(document.getElementById('pageSize').value);
      currentPage = 1;
      displayRecords(filteredRecords);
    }

    // Update summary cards
    function updateSummaryCards(records) {
      const totalEggs = records.reduce((sum, r) => sum + r.eggs, 0);
      const totalFlats = records.reduce((sum, r) => sum + r.flats, 0);
      const totalPackets = records.reduce((sum, r) => sum + r.packets, 0);

      document.getElementById('totalEggsCard').textContent = totalEggs.toLocaleString();
      document.getElementById('totalFlatsCard').textContent = totalFlats.toFixed(2);
      document.getElementById('totalPacketsCard').textContent = totalPackets.toFixed(2);
      document.getElementById('totalRecordsCard').textContent = records.length;
    }

    // Update individual farm summaries
    function updateFarmSummaries(records) {
      for (let i = 1; i <= 4; i++) {
        const farmRecords = records.filter(r => r.farmNumber === i);
        const totalEggs = farmRecords.reduce((sum, r) => sum + r.eggs, 0);
        const totalFlats = farmRecords.reduce((sum, r) => sum + r.flats, 0);
        const totalPackets = farmRecords.reduce((sum, r) => sum + r.packets, 0);

        document.getElementById(`farm${i}Eggs`).textContent = totalEggs.toLocaleString();
        document.getElementById(`farm${i}Flats`).textContent = totalFlats.toFixed(2);
        document.getElementById(`farm${i}Packets`).textContent = totalPackets.toFixed(2);
        document.getElementById(`farm${i}Records`).textContent = farmRecords.length;
      }
    }

    // Apply quick filter
    function applyQuickFilter() {
      const quickFilter = document.getElementById('filterQuick').value;
      const year = parseInt(document.getElementById('filterYear').value) || new Date().getFullYear();

      if (!quickFilter) return;

      let fromDate, toDate;

      if (quickFilter === 'today') {
        fromDate = toDate = new Date();
      } else if (quickFilter === 'week') {
        toDate = new Date();
        fromDate = new Date();
        fromDate.setDate(fromDate.getDate() - 7);
      } else if (quickFilter === 'month') {
        toDate = new Date();
        fromDate = new Date();
        fromDate.setDate(fromDate.getDate() - 30);
      } else if (quickFilter.startsWith('month')) {
        const monthNum = parseInt(quickFilter.replace('month', ''));
        fromDate = new Date(year, monthNum - 1, 1);
        toDate = new Date(year, monthNum, 0);
      }

      if (fromDate && toDate) {
        document.getElementById('filterDateFrom').value = fromDate.toISOString().split('T')[0];
        document.getElementById('filterDateTo').value = toDate.toISOString().split('T')[0];
        applyFilters();
      }
    }

    // Apply all filters
    function applyFilters() {
      let filtered = [...allRecords];

      // Farm filter
      const farmFilter = document.getElementById('filterFarm').value;
      if (farmFilter) {
        filtered = filtered.filter(r => r.farmNumber === parseInt(farmFilter));
      }

      // Date range filter
      const dateFrom = document.getElementById('filterDateFrom').value;
      const dateTo = document.getElementById('filterDateTo').value;
      if (dateFrom || dateTo) {
        filtered = filtered.filter(record => {
          const recordDate = new Date(record.createdAt);
          const from = dateFrom ? new Date(dateFrom) : new Date('1900-01-01');
          const to = dateTo ? new Date(dateTo) : new Date('2100-12-31');
          to.setHours(23, 59, 59, 999);
          return recordDate >= from && recordDate <= to;
        });
      }

      // Search filter
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      if (searchTerm) {
        filtered = filtered.filter(r =>
          r.eggs.toString().includes(searchTerm) ||
          r.flats.toString().includes(searchTerm) ||
          r.packets.toString().includes(searchTerm) ||
          r.farmName.includes(searchTerm)
        );
      }

      // Sort
      const sortBy = document.getElementById('sortBy').value;
      filtered = sortRecords(filtered, sortBy);

      filteredRecords = filtered;
      currentPage = 1;
      displayRecords(filtered);
      updateSummaryCards(filtered);
    }

    // Sort records
    function sortRecords(records, sortBy) {
      const sorted = [...records];

      switch (sortBy) {
        case 'date-desc':
          return sorted.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
        case 'date-asc':
          return sorted.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
        case 'eggs-desc':
          return sorted.sort((a, b) => b.eggs - a.eggs);
        case 'eggs-asc':
          return sorted.sort((a, b) => a.eggs - b.eggs);
        case 'farm-asc':
          return sorted.sort((a, b) => a.farmNumber - b.farmNumber);
        default:
          return sorted;
      }
    }

    // Clear filters
    function clearFilters() {
      document.getElementById('filterFarm').value = '';
      document.getElementById('filterDateFrom').value = '';
      document.getElementById('filterDateTo').value = '';
      document.getElementById('filterQuick').value = '';
      document.getElementById('searchInput').value = '';
      document.getElementById('sortBy').value = 'date-desc';
      document.getElementById('filterYear').value = new Date().getFullYear();

      filteredRecords = [...allRecords];
      currentPage = 1;
      displayRecords(filteredRecords);
      updateSummaryCards(filteredRecords);
    }
    // Real-time search
    document.getElementById('searchInput').addEventListener('input', () => {
      applyFilters();
    });

    // Real-time sort
    document.getElementById('sortBy').addEventListener('change', () => {
      applyFilters();
    });

    // Load data on page load
    loadAllFarmsData();
  </script>

</body>

</html>